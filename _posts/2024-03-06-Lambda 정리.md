---
layout: post
title: AWS Lambda ì •ë¦¬
date: 2024-03-06 18:00 +0900 
description: AWS Lambda ì •ë¦¬
category: [AWS, Lambda] 
tags: [Lambda, AWS, ëžŒë‹¤, ì„œë²„ë¦¬ìŠ¤] 
pin: false
math: true
mermaid: true
---
AWS Lambda ì •ë¦¬
<!--more-->


### ì„œë²„ë¦¬ìŠ¤


ì„œë²„ë¦¬ìŠ¤ëž€ ì„œë²„ë¥¼ ê´€ë¦¬í•´ë„ ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ëœ»ì´ë‹¤. ì—†ë‹¤ëŠ” ëœ»ì´ ì•„ë‹Œ, ìš°ë¦¬ëŠ” ì„œë²„ë¥¼ ê´€ë¦¬í•˜ì§€ ì•Šê³  ë‹¨ì§€ ì½”ë“œ(í•¨ìˆ˜)ë§Œ ì œëŒ€ë¡œ ìž‘ì„±í•˜ë©´ ëœë‹¤. ì›ëž˜ ì„œë²„ë¦¬ìŠ¤ëŠ” FaaS(Funtion as a Service)ë¥¼ ì˜ë¯¸í–ˆì§€ë§Œ ì§€ê¸ˆì€ ë” í¬ê´„ì ì¸ ì˜ë¯¸ë¥¼ ê°€ì§„ë‹¤ê³  í•œë‹¤. ì•„ëž˜ëŠ” AWS ì„œë²„ë¦¬ìŠ¤ ì„œë¹„ìŠ¤ ëª©ë¡ì´ë©°, ì˜¤ëŠ˜ì€ Lambdaë¥¼ ìžì„¸ížˆ ì•Œì•„ë³¸ë‹¤.


> ðŸ’¡ **AWS ì„œë²„ë¦¬ìŠ¤ ì„œë¹„ìŠ¤**  
> - AWS Lambda  
>   
> - DynamoDB  
>   
> - AWS Cognito  
>   
> - AWS API Gateway  
>   
> - Amazon S3  
>   
> - AWS SNS & SQS  
>   
> - AWS Kinesis Data Firehose  
>   
> - Aurora Serverless  
>   
> - Step Functions  
>   
> - Fargate

	- AWS Lambda
	- DynamoDB
	- AWS Cognito
	- AWS API Gateway
	- Amazon S3
	- AWS SNS & SQS
	- AWS Kinesis Data Firehose
	- Aurora Serverless
	- Step Functions
	- Fargate

## Lambda


AWSì˜ ì„œë²„ë¦¬ìŠ¤ ì„œë¹„ìŠ¤ ì¤‘ í•˜ë‚˜ë¡œ **ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë°©ì‹ì˜** **ì„œë²„ë¦¬ìŠ¤**ì´ë‹¤. ìš°ë¦¬ëŠ” ëžŒë‹¤ë¥¼ ì´ìš©í•˜ë©´ ì½”ë“œë§Œ ìž‘ì„±í•˜ë©´ ëœë‹¤. ëžŒë‹¤ëŠ” CloudWatchë¥¼ í†µí•´ ë¡œê·¸ì™€ ì§€í‘œë¥¼ í™•ì¸í•  ìˆ˜ ìž‡ë‹¤. ë˜í•œ, ë©”ëª¨ë¦¬ ìš©ëŸ‰ì„ ë†’ì´ë©´ CPU ì„±ëŠ¥ê³¼ ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ì´ ì˜¬ë¼ê°„ë‹¤. 


ëžŒë‹¤ëŠ” ë‹¨ìˆœí•œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ê°€ ì•„ë‹Œ ëžŒë‹¤ APIë¥¼ ë§Œì¡±í•˜ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì—¬ì•¼ í•œë‹¤. ì¼ë°˜ ì´ë¯¸ì§€ëŠ” ECS or Fargateì—ì„œ ì‹¤í–‰í•œë‹¤.


** ëžŒë‹¤ëŠ” ì´ë²¤íŠ¸ê¸°ë°˜ìœ¼ë¡œ í˜¸ì¶œë˜ê¸°ì— ë³„ë„ì˜ ìºì‹±ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.


### ê³¼ê¸ˆ


[ì—¬ê¸°](https://aws.amazon.com/lambda/pricing/)ì—ì„œ ìžì„¸í•œ ë‚´ìš©ì„ ì‚´íŽ´ë³¼ ìˆ˜ ìžˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ê³¼ê¸ˆì€ ìš”ì²­íšŸìˆ˜ì™€, ëžŒë‹¤í•¨ìˆ˜ ì‹¤í–‰ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ê³¼ê¸ˆí•œë‹¤.


ê¸°ë³¸ì ìœ¼ë¡œ 1,000,000ê°œì˜ ìš”ì²­ì€ ë¬´ë£Œì´ê³ , ì´í›„ë¶€í„° 100ë§Œê°œì˜ ìš”ì²­ë‹¹ 0.2ë‹¬ëŸ¬ì˜ ìš”ê¸ˆì„ ë¶€ê³¼í•œë‹¤. 


ì´ˆê¸° 400,000GB/sëŠ” ë¬´ë£Œì´ë©°, 600,00GB/sì— ëŒ€í•´ 1ë‹¬ëŸ¬ì˜ ìš”ê¸ˆì„ ë¶€ê³¼í•œë‹¤. 


ì—¬ê¸°ì„œ GBëŠ” ë©”ëª¨ë¦¬ìš©ëŸ‰ì„ ì˜ë¯¸í•œë‹¤. ì¦‰ ë©”ëª¨ë¦¬ 1GBë¡œ ë™ìž‘í•˜ëŠ” ëžŒë‹¤ í•¨ìˆ˜ì— ëŒ€í•´ 400,000ì´ˆê¹Œì§€ëŠ” ë¬´ë£Œì´ë©° ì´í›„ 600,000ì´ˆê°€ ê²½ê³¼í–ˆì„ ë•Œë§ˆë‹¤ 1ë‹¬ëŸ¬ë¥¼ ë¶€ê³¼í•œë‹¤. 


ë‚´ê°€ ì‹¤ì œë¡œ 10ì›”ë¶€í„° ì¼ë˜ ëžŒë‹¤í•¨ìˆ˜ëŠ” ë©”ëª¨ë¦¬ì‚¬ì´ì¦ˆê°€ 256MB, 100msìœ¼ë¡œ ì•„ì§ ê³¼ê¸ˆë˜ì§€ë„ ì•Šì•˜ë‹¤.


![Untitled.png](/assets/img/post/Lambda%20ì •ë¦¬/1.png)


### Limit

- ì‹¤í–‰
	- ë©”ëª¨ë¦¬: 128MB ~ 10GB
	- **ìµœëŒ€ì‹¤í–‰ì‹œê°„: 900ì´ˆ(15ë¶„)**
	- **í™˜ê²½ ë³€ìˆ˜: 4KB**
	- ì»¨í…Œì´ë„ˆ ë””ìŠ¤í¬ ìš©ëŸ‰(`/tmp`): 512MB ~ 10GB
	- ìµœëŒ€ ë™ì‹œì— ì‹¤í–‰í•  ìˆ˜ ìžˆëŠ” ëžŒë‹¤ í•¨ìˆ˜ì˜ ìˆ˜: 1000ê°œ
- ë°°í¬
	- ëžŒë‹¤ í•¨ìˆ˜ ë°°í¬ ì‚¬ì´ì¦ˆ(ì••ì¶•): 50MB
	- ëžŒë‹¤ í•¨ìˆ˜ ë°°í¬ ì‚¬ì´ì¦ˆ(ì½”ë“œ + ì˜ì¡´ì„±): 250MB
		- ë§Œì•½ ìš©ëŸ‰ì„ ë„˜ê¸°ë©´ /tmpë¥¼ ë¡œë“œ ë””ë ‰í„°ë¦¬ë¡œ ì‚¬ìš©í•  ìˆ˜ ìžˆìŒ
	- ìµœëŒ€ í™˜ê²½ ë³€ìˆ˜ 4KB

### ë‹¨ì 


ìœ„ì—ì„œ ëžŒë‹¤ì˜ íŠ¹ì§•ê³¼ ìž¥ì ì„ ìœ„ì£¼ë¡œ ì•Œì•„ë´¤ë‹¤. ì´ë¡ ìƒìœ¼ë¡œ ê°œë°œìžëŠ” ì¸í”„ë¼ë¥¼ ì‹ ê²½ì“°ì§€ ì•Šê³  ì½”ë“œë§Œ ìž‘ì„±í•˜ë©´ ëœë‹¤. í•˜ì§€ë§Œ ì•„ëž˜ì™€ ê°™ì€ ë‹¨ì ë„ ìžˆë‹¤.

1. ë¦¬ì†ŒìŠ¤ ì œí•œ: ìµœëŒ€ ì‹¤í–‰ì‹œê°„, í™˜ê²½ë³€ìˆ˜ ìš©ëŸ‰ ë“±ì˜ ì œí•œì´ ìžˆë‹¤.
2. Stateless: ëžŒë‹¤ëŠ” í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë©´, ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆë¥¼ ë„ìš°ëŠ” ë°©ì‹ì´ë‹¤. ë³„ë„ì˜ ìƒíƒœë¥¼ ì €ìž¥í•˜ì§€ ì•ŠëŠ”ë‹¤.
3. Cold Start: ëžŒë‹¤ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´, ì˜¤ëž«ë™ì•ˆ ì‚¬ìš©í•˜ì§€ ì•Šì„ ê²½ìš° ì»´í“¨íŒ…íŒŒì›Œë¥¼ ìž ì‹œ êº¼ë‘”ë‹¤. ì¦‰, ìš”ì²­ì´ ì˜¤ëžœë§Œì— ì˜¤ë©´ ì–´ëŠì •ë„ ë”œë ˆì´ê°€ ê±¸ë¦°ë‹¤.
4. ë™ì‹œì„± ì œí•œ: ë™ì‹œì— ì‹¤í–‰í•  ìˆ˜ ìžˆëŠ” ëžŒë‹¤í•¨ìˆ˜ì˜ ê°œìˆ˜ë¥¼ ìµœëŒ€ 1,000ê°œë¡œ ì œí•œëœë‹¤.

ë¬¼ë¡ , ì—¬ëŸ¬ ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ ìœ„ì˜ ë‹¨ì ì„ ìƒì‡„í•  ìˆ˜ ìžˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 3ë²ˆê³¼ ê°™ì€ ê²½ìš° ëžŒë‹¤ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ í˜¸ì¶œí•˜ê±°ë‚˜ ë©”ëª¨ë¦¬ ìŠ¤íŽ™ì„ ì˜¬ë ¤ ì„±ëŠ¥ì„ ì—…ê·¸ë ˆì´ë“œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìžˆë‹¤. 


### AWS SAM


ì‹¤ì œ ëžŒë‹¤ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” AWS SAMì„ ì´ìš©í•˜ë©´ ë§¤ìš° íŽ¸ë¦¬í•˜ë‹¤. AWS SAMì€ Serverless Application Modelìœ¼ë¡œ AWS í™˜ê²½ì—ì„œ ì œê³µí•˜ëŠ” ì„œë²„ë¦¬ìŠ¤ìš© ì˜¤í”ˆì†ŒìŠ¤ í”„ë ˆìž„ì›Œí¬ì´ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ CloudFormationì´ í™•ìž¥ëœ í˜•íƒœì´ë‹¤. SAM íƒ¬í”Œë¦¿ì´ ë°°í¬ë‹¹ì‹œ CloudFormation íƒ¬í”Œë¦¿ìœ¼ë¡œ ë³€í™˜ëœë‹¤.


AWS SAMì„ ì‚¬ìš©í•˜ë©´ ì•„ëž˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•  ë•Œ, ì•„ì£¼ íŽ¸ë¦¬í•˜ê²Œ ì´ìš©í•  ìˆ˜ ìžˆë‹¤. SAM ëª…ë ¹ì–´ë¥¼ í†µí•´ **Dockerê¸°ë°˜ìœ¼ë¡œ ë¡œì»¬ì—ì„œë„ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥**í•˜ë©°, **í…ŒìŠ¤íŠ¸ í›„** **`sam deploy`** **ëª…ë ¹ì–´ë¥¼ í†µí•´ ì‰½ê²Œ ë°°í¬**í•  ìˆ˜ ìžˆë‹¤.

- ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ ëª©ë¡
	- Lambda
	- API ê²Œì´íŠ¸ì›¨ì´
	- DynamoDB

AWS SAM í”„ë¡œì íŠ¸ëŠ” [GitHub](https://github.com/aws/serverless-application-model)ì—ì„œ í™•ì¸í•  ìˆ˜ ìžˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì£¼ìš” ì„¤ì •ì„ template.yamlì—ì„œ ê´€ë¦¬í•˜ë©° í•´ë‹¹ yaml íŒŒì¼ì„ í†µí•´ ì„œë¹„ìŠ¤ ì˜µì…˜ì„ ì„¤ì •í•  ìˆ˜ ìžˆë‹¤.


ì•„ëž˜ëŠ” ë¸”ë¡œê·¸ì™€ ë…¸ì…˜ì„ ì—°ë™í•˜ëŠ” ìš©ë„ë¡œ ì œìž‘í•œ Lambda + API Gatewayì— ëŒ€í•œ ì„¤ì •ì´ë‹¤.


```yaml
AWSTemplateFormatVersion: 2010-09-09
Description: >-
  notion-sam
Transform:
  - AWS::Serverless-2016-10-31
Resources:
  blog:
    Type: AWS::Serverless::Function
    Properties:
      Handler: src/handlers/blog.Handler
      Runtime: nodejs18.x
      Architectures:
        - x86_64
      MemorySize: 256
      Timeout: 300
      Description: Notion to GitHub
      Environment:
        Variables:
          NOTION_SECRET_API_KEY: "{{resolve:secretsmanager:Blog:SecretString:NOTION_SECRET_API_KEY}}"
          GITHUB_TOKEN: "{{resolve:secretsmanager:Blog:SecretString:GITHUB_TOKEN}}"

      Policies:
        - Version: "2012-10-17"
          Statement:
            - Effect: "Allow"
              Action: "secretsmanager:GetSecretValue"
              Resource:
                - !Sub "arn:aws:secretsmanager:${AWS::Region}:${AWS::AccountId}:secret:Blog"
                - !Sub "arn:aws:secretsmanager:${AWS::Region}:${AWS::AccountId}:secret:googleAPI"
      Events:
        Api:
          Type: Api
          Properties:
            Path: /{pageid}/{title}
            Method: get

# ì¶œë ¥
Outputs:
  WebEndpoint:
    Description: API Gateway endpoint URL for Prod stage
    Value: !Sub "https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/"

```

